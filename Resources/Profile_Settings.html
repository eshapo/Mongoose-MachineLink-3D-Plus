<!doctype html>
<html class="no-js" lang="en">
<!--
  Common include to check the session is current and if not redirect to the
  login page, then after logging in redirect back to the referring page.
  Note a redirect on a non-root user can be effected by defining the
  pre-processor symbol "CHECK_ROOT_USER" before including this file.
-->
<!-- <%
// Check the session, if timed out redirect, and pass the referring page as
// an argument. This allows index.html to redirect back to the referring page.
useSession();
if (
    request["SESSION_ID"] != session["sessionid"]) {
  redirect('/index.html?src=' + request["SCRIPT_NAME"]);
  exit(403);
}
%> -->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Profile Settings</title>

<script>
(function() {
 var html = document.documentElement;
 html.className = html.className.replace('no-js','') + ' js';
})();
var modules = [];
</script>
<!--[if lt IE 9]>
<script src="vdf-lib/js/lib/selectivizr.min.js"></script>
<script src="js/libs/html5-shiv.min.js"></script>
<noscript>
 <link rel="stylesheet" href="vdf-lib/css/ie/ie.min.css">
</noscript>
<![endif]-->
<!--[if IE 6]>
<link rel="stylesheet" href="css/ie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="css/ie7.css">
<![endif]-->
<!--[if lte IE 7]>
<link rel="stylesheet" href="css/ie6-ie7.css">
<![endif]-->
<link rel="stylesheet" href="vdf-lib/css/main.min.css?2.0.18.9">
<link rel="stylesheet" href="css/style.css?2.0.18.9">
<link rel="stylesheet" href="css/jquery-ui.css">
<link rel="shortcun icon" type="image/x-icon" href="favicon.ico">
</head>
<!--[if IE 6]>
 <body class="ie ie6">
<![endif]-->
<!--[if IE 7]>
 <body class="ie ie7">
<![endif]-->
<!--[if IE 8]>
 <body class="ie ie8">
<![endif]-->
<!--[if IE 9]>
 <body class="ie ie9">
<![endif]-->
<!--[if gt IE 9]>
 <body>
<![endif]-->
<!--[if !IE]><!-->
<body>
<!--<![endif]-->
<script src="js/jquery.min.js?2.0.18.9" type="text/javascript"></script>
<script src="js/jquery.validate.min.js?2.0.18.9" type="text/javascript" charset="utf-8"></script>
<script src="js/script.js?2.0.18.9"></script>
<script src="vdf-lib/js/main.min.js?2.0.18.9"></script>
<!--**********************************************************-->
<script type="text/javascript" src="lang/b28n.js?2.0.18.9"></script>
<script language="JavaScript" src="js/jquery.blockUI.js"></script>
<script src="js/jquery-ui.js"></script>
<script src="js/jquery.ui.touch-punch.min.js"></script>
<script type="text/javascript" src="util.js?2.0.18.9"></script>
<script language='javascript'>
var fn="Profile_Settings.html".replace(".html", "");
if(fn=="" || fn=="/") {
 fn="index";
}
Butterlate.setTextDomain(fn.replace("/", ""));
$.blockUI.defaults.css.padding="20px 0 20px 0";
var roam_simcard="0";
if(!is_touch_device()) {$("head").append("<style type='text/css'>.footer {position:fixed;}</style>");}
</script>
<!--<script language="JavaScript" src="cgi-bin/ajax.cgi?getProfiles"></script>-->
<script language="javascript">

var stpf=[{ "name":"Profile1", "conntype":"","enable":"1", "profilenum":"1", "dialnum":"atd*99#", "user":"","pass":"","routes":"","snat":"1", "metric":"20", "userpeerdns":"1", "readonly":"0", "reconnect_delay":"30", "reconnect_retries":"0", "authtype":"chap", "padmode":"tcp","port":"0","host":"0.0.0.0","pad_o":"0","connection_op":"1","tcp_nodelay":"0","autoapn":"1", "preferredIPEnable":"","preferredIPAddr":"","APNName":"" },{ "name":"Profile2", "conntype":"","enable":"0", "profilenum":"2", "dialnum":"atd*99#", "user":"","pass":"","routes":"","snat":"1", "metric":"20", "userpeerdns":"1", "readonly":"0", "reconnect_delay":"30", "reconnect_retries":"0", "authtype":"chap", "padmode":"tcp","port":"0","host":"0.0.0.0","pad_o":"0","connection_op":"1","tcp_nodelay":"0","autoapn":"0", "preferredIPEnable":"","preferredIPAddr":"","APNName":"" },{ "name":"Profile3", "conntype":"","enable":"0", "profilenum":"3", "dialnum":"atd*99#", "user":"","pass":"","routes":"","snat":"1", "metric":"20", "userpeerdns":"1", "readonly":"0", "reconnect_delay":"30", "reconnect_retries":"0", "authtype":"chap", "padmode":"tcp","port":"0","host":"0.0.0.0","pad_o":"0","connection_op":"1","tcp_nodelay":"0","autoapn":"0", "preferredIPEnable":"","preferredIPAddr":"","APNName":"" },{ "name":"Profile4", "conntype":"","enable":"0", "profilenum":"4", "dialnum":"atd*99#", "user":"","pass":"","routes":"","snat":"1", "metric":"20", "userpeerdns":"1", "readonly":"0", "reconnect_delay":"30", "reconnect_retries":"0", "authtype":"chap", "padmode":"tcp","port":"0","host":"0.0.0.0","pad_o":"0","connection_op":"1","tcp_nodelay":"0","autoapn":"0", "preferredIPEnable":"","preferredIPAddr":"","APNName":"" },{ "name":"Profile5", "conntype":"","enable":"0", "profilenum":"5", "dialnum":"atd*99#", "user":"","pass":"","routes":"","snat":"1", "metric":"20", "userpeerdns":"1", "readonly":"0", "reconnect_delay":"30", "reconnect_retries":"0", "authtype":"chap", "padmode":"tcp","port":"0","host":"0.0.0.0","pad_o":"0","connection_op":"1","tcp_nodelay":"0","autoapn":"0", "preferredIPEnable":"","preferredIPAddr":"","APNName":"" },{ "name":"Profile6", "conntype":"","enable":"0", "profilenum":"6", "dialnum":"atd*99#", "user":"","pass":"","routes":"","snat":"1", "metric":"20", "userpeerdns":"1", "readonly":"0", "reconnect_delay":"30", "reconnect_retries":"0", "authtype":"chap", "padmode":"tcp","port":"0","host":"0.0.0.0","pad_o":"0","connection_op":"1","tcp_nodelay":"0","autoapn":"0", "preferredIPEnable":"","preferredIPAddr":"","APNName":"" }];var def_profile=1; 

</script>
<!-- <%
plmn_mcc=get_single('wwan.0.imsi.plmn_mcc');
plmn_mnc=get_single('wwan.0.imsi.plmn_mnc');
if (plmn_mcc == '505' && (plmn_mnc == '01' || plmn_mnc == '1')) {
 isp_telstra = 1
}
else {
 isp_telstra = 0
}
if (isp_telstra == 1) {
 _mtu = get_single( 'system.config.telstra.mtu' );
 if (_mtu < 1358 || _mtu > 1460) {
  _mtu = 1358;
  retval=set_single( 'system.config.telstra.mtu='+_mtu, '-p' );
 }
}
else {
 _mtu = get_single( 'system.config.mtu' );
}
i = form['profileidx'];
if (request['REQUEST_METHOD'] == "POST") {
 set_single( 'link.profile.'+i+'.routes='+form['routes'], '-p' );
 set_single( 'link.profile.'+i+'.preferred_ip.enable='+form['preferred_ipenable'], '-p' );
 set_single( 'link.profile.'+i+'.preferred_ip.addr='+form['preferred_ipaddr'], '-p' );
 tempval = form['profilename'];
 set_single( 'link.profile.'+i+'.name='+tempval, '-p' );
 tempval = form['APNName'];
 set_single( 'link.profile.'+i+'.apn='+tempval, '-p' );
 tempval = form['pppuser'];
 set_single( 'link.profile.'+i+'.user='+tempval, '-p' );
 tempval = form['ppppass'];
 set_single( 'link.profile.'+i+'.pass='+tempval, '-p' );
 tempval = form['snatEnable'];
 set_single( 'link.profile.'+i+'.snat='+tempval, '-p' );
 tempval = form['reconnectDelay'];
 set_single( 'link.profile.'+i+'.reconnect_delay='+tempval, '-p' );
 tempval = form['reconnectRetries'];
 set_single( 'link.profile.'+i+'.reconnect_retries='+tempval, '-p' );
 tempval = form['metric'];
 set_single( 'link.profile.'+i+'.defaultroutemetric='+tempval, '-p' );
 tempval = form['AuthType'];
 set_single( 'link.profile.'+i+'.auth_type='+tempval, '-p');
 autoapn=form['autoapn'];
 set_single( 'link.profile.'+i+'.autoapn='+autoapn, '-p');
 tempval = form['mtu'];
 if (isp_telstra == 1)
  retval=set_single( 'system.config.telstra.mtu='+tempval, '-p' );
 else
  retval=set_single( 'system.config.mtu='+tempval, '-p' );
 gasc = form['gascEnable'];
 if( gasc=='1' ) {
  //need re-enable wwan if MTU is changed
  if(tempval != _mtu) {
   set_single( 'link.profile.'+i+'.enable=0', '-p' );
   esp_sleep(1000);
  }
  set_single( 'link.profile.'+i+'.enable=1', '-p' );
 }
 else {
  set_single( 'link.profile.'+i+'.enable=0', '-p' );
 }
 redirect('/Profile_Name_List.html?success');
}
else { //GET
 form['mtu'] = _mtu;
}
idx=request['QUERY_STRING'];
if( idx>=0 && idx<6 ) {
 form['profileidx'] = idx+1;
}
else {
 form['profileidx'] = 1;
}
var _custom_roam_simcard=get_single("manualroam.custom_roam_simcard");
%> -->
<script language='javascript'>
/*****************net_util.js************************/
function WinExpIP(field,event) {
 if( field.value=="") {
  if($(field).hasClass("required")) {
   $(field).valid();
  }
 }
 else {
  if(!isValidIpEntry(field,event))
   validate_alert( "", "You must enter a value between 0 and 255. Please try again.");
  else
   clear_alert();
 }
}
function WinExpIP_1(field,event) {
 if( field.value=="") {
  if($(field).hasClass("required")) {
   $(field).valid();
  }
 }
 else {
  switch(isValidIpEntry_1(field,event)) {
  case -1:
   validate_alert( "", "You must enter a value between 1 and 223. Please try again.");
  break;
  case -2:
   validate_alert( "", "An IP address can't start with 127. Please try another value between 1 and 223.");
  break;
  default:
   clear_alert();
  break;
  }
 }
}
function WinExpIP_0(field,event) {
 if( field.value=="") {
  if($(field).hasClass("required")) {
   $(field).valid();
  }
 }
 else {
  if(isNValidIP(field.value))
   validate_alert( "", "Please specify a value between 0 and 255.");
  else
   clear_alert();
 }
}
function WinExpIP_127(field,event) {
 if( field.value=="") {
  if($(field).hasClass("required")) {
   $(field).valid();
  }
 }
 else {
  if(isNValidIP(field.value) || field.value <1 || field.value >223)
   validate_alert( "", "dhcp warningMsg1");
  else
   clear_alert();
 }
}
function hostMin(ip, mask) {
 var host_array=new Array();
 ip_array = ip.split('.');
 mask_array = mask.split('.');
 for (i = 0; i < 4; i++) {
  host_array[i] = parseInt(ip_array[i])&parseInt(mask_array[i]);
 }
 host_array[3]++;
 return host_array.join(".");
}
function hostMax(ip, mask) {
 var host_array=new Array();
 var wildcard_array=new Array();
 ip_array = ip.split('.');
 mask_array = mask.split('.');
 for (i = 0; i < 4; i++) {
  wildcard_array[i]=~parseInt(mask_array[i])&255;
  host_array[i] = parseInt(ip_array[i])&parseInt(mask_array[i])|wildcard_array[i];
 }
 host_array[3]--;
 return host_array.join(".");
}
function checkIPrange(ipMin, ipMax, myip) {
var fromArr = ipMin.split(".");
var toArr = ipMax.split(".");
var myipArr = myip.split(".");
var fromip=0; toip=0; myip=0;
 for(i=0;i<4;i++) {
  fromip=fromip*1000+parseInt(fromArr[i]);
  toip=toip*1000+parseInt(toArr[i]);
  myip=myip*1000+parseInt(myipArr[i]);
 }
 if(myip<fromip || myip>toip) {
  return false;
 }
 return true;
}
function isWithinHostIpRange(ip, mask, myip) {
 return checkIPrange(hostMin(ip, mask), hostMax(ip, mask), myip);
}
function checkIpAddr(field, ismask, msg) {
 if (field.value == "") {
  if (ismask) {
   validate_alert( "", typeof(msg)!="undefined"?msg+"You must enter a netmask. Please try again.":"You must enter a netmask. Please try again.");//The netmask is empty.
  }
  else {
   validate_alert( "", typeof(msg)!="undefined"?msg+"The IP address is empty. Please try again.":"The IP address is empty. Please try again.");//IP address is empty.
  }
  field.value = field.defaultValue;
  field.focus();
  return false;
 }
 if (isAllNum(field.value) == 0) {
  validate_alert( "", typeof(msg)!="undefined"?msg+"You must enter a number between [1-9]. Please try again.":"You must enter a number between [1-9]. Please try again.");//'It should be a [0-9] number.'
  field.value = field.defaultValue;
  field.focus();
  return false;
 }
 if (ismask) {
  if ((!checkRange(field.value, 1, 0, 256)) ||
   (!checkRange(field.value, 2, 0, 256)) ||
   (!checkRange(field.value, 3, 0, 256)) ||
   (!checkRange(field.value, 4, 0, 256)))
  {
   validate_alert( "", typeof(msg)!="undefined"?msg+"You have entered the netmask incorrectly. Please try again.":"You have entered the netmask incorrectly. Please try again.");//'The netmask has wrong format.'
   field.value = field.defaultValue;
   field.focus();
   return false;
  }
 }
 else {
  if ((!checkRange(field.value, 1, 0, 255)) ||
   (!checkRange(field.value, 2, 0, 255)) ||
   (!checkRange(field.value, 3, 0, 255)) ||
   (!checkRange(field.value, 4, 1, 254)))
  {
   if (ismask) {
    validate_alert( "", typeof(msg)!="undefined"?msg+"You have entered the netmask incorrectly. Please try again.":"You have entered the netmask incorrectly. Please try again.");//'The netmask has wrong format.'
   }
   else {
    validate_alert( "", typeof(msg)!="undefined"?msg+"You have entered the IP address incorrectly. Please try again.":"You have entered the IP address incorrectly. Please try again.");//'IP adress format error.'
   }
   field.value = field.defaultValue;
   field.focus();
   return false;
  }
 }
 clear_alert();
 return true;
}
function parse_ip_into_fields(ipaddr, name) {
 var i;
 var ip_array;
 ip_array=ipaddr.split(".");
 if(ip_array.length != 4 ) {ip_array[0]=''; ip_array[1]='';ip_array[2]=''; ip_array[3]='';}
 for(i=0;i<4;i++) {
  $("input[name="+name+(i+1)+"]").val(ip_array[i]||"");
 }
}
function parse_ip_from_fields(documentItem) {
 var ip_array=new Array();
 var val;
 var j=0;
 for(var i=0;i<4;i++) {
  val=$("input[name="+documentItem+(i+1)+"]").val();
  if(val!="") {
   ip_array[j++]=val;
  }
 /*	else {
			return "";
		}*/
 }
 return ip_array.join(".");
}
function ValidSubnetMask(n, t){
 NumfieldEntry(t);
 if(isValidSubnetMask(parse_ip_from_fields(n))<0) {
  for(i=0;i<4;i++) {
   $("input[name="+n+(i+1)+"]").removeClass("success-text").addClass("failure-text");
  }
 }
 else {
  for(i=0;i<4;i++) {
   $("input[name="+n+(i+1)+"]").removeClass("failure-text").addClass("success-text");
  }
 }
}
function htmlGenIpBlocks(name_in) {
 h="<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"1' id='"+name_in+"1' onkeyup='NumfieldEntry(this);WinExpIP_1(this,event)'></div>	<label for='"+name_in+"1' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"2' id='"+name_in+"2' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"2' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"3' id='"+name_in+"3' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"3' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"4' id='"+name_in+"4' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"4' class='input-connect-dot'></label>";
 printf(h);
}
function htmlGenIpBlocks0(name_in) {
 h="<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"1' id='"+name_in+"1' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"1' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"2' id='"+name_in+"2' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"2' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"3' id='"+name_in+"3' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"3' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"4' id='"+name_in+"4' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"4' class='input-connect-dot'></label>";
 printf(h);
}
function htmlGenIpBlocks127(name_in) {
 h="<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"1' id='"+name_in+"1' onkeyup='NumfieldEntry(this);WinExpIP_127(this,event)'></div>	<label for='"+name_in+"1' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"2' id='"+name_in+"2' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"2' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"3' id='"+name_in+"3' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"3' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='"+name_in+"4' id='"+name_in+"4' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"4' class='input-connect-dot'></label>";
 printf(h);
}
function htmlGenMaskBlocks(name_in) {
 printf("<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='%s1' id='%s1' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label for='"+name_in+"1' class='input-connect-dot'>.</label>");
 printf("<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='%s2' id='%s2' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label for='"+name_in+"2' class='input-connect-dot'>.</label>");
 printf("<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='%s3' id='%s3' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label for='"+name_in+"3' class='input-connect-dot'>.</label>");
 printf("<div class='field'><input type='text' class='required ip-adress' maxLength='3' name='%s4' id='%s4' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label for='"+name_in+"4' class='input-connect-dot'></label>");
}
function htmlGenIpBlocksWithoutRequired(name_in) {
 h="<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"1' id='"+name_in+"1' onkeyup='NumfieldEntry(this);WinExpIP_1(this,event)'></div>	<label for='"+name_in+"1' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"2' id='"+name_in+"2' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"2' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"3' id='"+name_in+"3' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"3' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"4' id='"+name_in+"4' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>	<label for='"+name_in+"4' class='input-connect-dot'></label>";
 printf(h);
}
function htmlGenIpBlocksWithoutRequired0(name_in) {
 h="<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"1' id='"+name_in+"1' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"1' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"2' id='"+name_in+"2' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"2' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"3' id='"+name_in+"3' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"3' class='input-connect-dot'>.</label>	<div class='field'><input type='text' class='ip-adress' maxLength='3' name='"+name_in+"4' id='"+name_in+"4' onkeyup='NumfieldEntry(this);WinExpIP_0(this,event)'></div>	<label for='"+name_in+"4' class='input-connect-dot'></label>";
 printf(h);
}
function htmlGenMaskBlocksWithoutRequired(name_in) {
 printf("<div class='field'><input type='text' class='ip-adress' maxLength='3' name='%s1' id='%s1' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label class='input-connect-dot'>.</label>");
 printf("<div class='field'><input type='text' class='ip-adress' maxLength='3' name='%s2' id='%s2' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label class='input-connect-dot'>.</label>");
 printf("<div class='field'><input type='text' class='ip-adress' maxLength='3' name='%s3' id='%s3' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label class='input-connect-dot'>.</label>");
 printf("<div class='field'><input type='text' class='ip-adress' maxLength='3' name='%s4' id='%s4' onkeyup='NumfieldEntry(this);WinExpIP(this,event)'></div>",name_in,name_in);
 printf("<label class='input-connect-dot'></label>");
}
/******************End of net_util.js***********************/
var roam_simcard="0";
function autoAPNchange() {
 if(document.formS.autoapnRadio[0].checked==true) {
  $(".hide_for_autoapn").css("display","none");
  $("#autoapn").val("1");
  $(".show_for_autoapn").css("display","");
 }
 else {
  $(".hide_for_autoapn").css("display","");
  $("#autoapn").val("0");
 }
}
function prefIPchange() {
 if(document.formS.prefIpRadio[0].checked==true) {
  $("#preferred_ipenable").val("1");
  $(".show_for_perferredipaddr").css("display","");
 }
 else {
  $("#preferred_ipenable").val("0");
  $(".show_for_perferredipaddr").css("display","none");
 }
}
function Init_Form() {
 /*var i = document.getElementById("profileidx").value-1;
 if(i=="") {
  i=0;
 }*/
 
 var rhyan_url=window.location.href;
 var rhyan_search=rhyan_url.search("html?");
 var i=rhyan_url.slice(rhyan_search+5,rhyan_search+6);
 
 var network_netmask=new Array();
 if(stpf[i].routes!==undefined)
 network_netmask=stpf[i].routes.split("/");
 if(network_netmask[0]===undefined)
  network_netmask[0]="";
 if(network_netmask[1]===undefined)
  network_netmask[1]="";
 parse_ip_into_fields(network_netmask[0],"network");
 parse_ip_into_fields(network_netmask[1],"netmask");
// <start> To support perferred WWAN IP 
 if (stpf[i].preferredIPAddr != undefined)
  parse_ip_into_fields(stpf[i].preferredIPAddr,"preferred_ipaddr");
 else
  parse_ip_into_fields("","preferred_ipaddr");
 $("#preferred_ipenable").val(stpf[i].preferredIPEnable);
 if(stpf[i].preferredIPEnable=="1") {
  $("#prefIpRadio-0").attr("checked", "checked");
  $(".show_for_perferredipaddr").css("display","");
 }
 else {
  $("#prefIpRadio-1").attr("checked", "checked");
  $(".show_for_perferredipaddr").css("display","none");
 }
 var uboot_hw_id="NWL-12-01";
 switch(uboot_hw_id) {
  case "NTC-6200-11":
  case "NTC-6200-12":
  case "NTC-6200-13":
   $(".show_for_perferredip").css("display","");
   break;
  default:
   $(".show_for_perferredip").css("display","none");
   break;
 }
// < end > To support perferred WWAN IP 
 $("#profilename").val(stpf[i].name);
 $("#APNName").val(stpf[i].APNName);
 $("#pppuser").val(stpf[i].user);
 $("#ppppass").val(stpf[i].pass);
 $("#reconnectDelay").val(stpf[i].reconnect_delay);
 $("#reconnectRetries").val(stpf[i].reconnect_retries);
 $("#metric").val(stpf[i].metric);
 if( stpf[i].authtype=="chap" )
  $("#AuthType-0").attr("checked", "checked");
 else
  $("#AuthType-1").attr("checked", "checked");
 document.formS.snatEnable.value = stpf[i].snat;
 if( parseInt(document.formS.snatEnable.value)==1 ) {
  $("#NatEnable-0").attr("checked", "checked");
 }
 else {
  $("#NatEnable-1").attr("checked", "checked");
 }
 if ( (document.formS.reconnectDelay.value < 30 ) || (document.formS.reconnectDelay.value > 65535) ) {
  document.formS.reconnectDelay.value = 30;
 }
 if ( (document.formS.reconnectRetries.value == "N/A") ||(document.formS.reconnectRetries.value < 0 ) || (document.formS.reconnectRetries.value > 65535) ) {
  document.formS.reconnectRetries.value = 0;
 }
 if( stpf[i].readonly == '1' ) {
  document.formS.pppuser.disabled = true;
  document.formS.APNName.disabled = true;
  var e=document.formS.countryList;
  if(typeof(e) != "undefined")
   e.disabled = true;
  e = document.getElementById( "nav2" );
  if(e)
   e.style['display']='none';
  document.formS.ppppass.disabled = true;
 }
 else {
  document.formS.pppuser.disabled = false;
  document.formS.APNName.disabled = false;
  document.formS.ppppass.disabled = false;
 }
 if(roam_simcard == "1") {
  autoapn=0;
  $("#div_autoapn").css("display","none");
 }
 else {
  autoapn=stpf[i].autoapn;
 }
 $("#gascEnable").val(stpf[i].enable);
 if( stpf[i].enable==1 ) {
  $("#pppAutoCon-0").attr("checked", "checked");
  $(".hide_profile_off").css("display","");
  if(autoapn=="1") {
   $(".show_for_autoapn").css("display","");
   $(".hide_for_autoapn").css("display","none");
  }
  else {
   $(".hide_for_autoapn").css("display","");
  }
 }
 else {
  $("#pppAutoCon-1").attr("checked", "checked");
  $(".hide_profile_off").css("display","none");
 }
 if(roam_simcard == "1") {
  $("#div_autoapn").css("display","none");
 }
 $("#autoapn").val(autoapn);
 if(autoapn=="1") {
  $("#autoapnRadio-0").attr("checked", "checked");
 }
 else {
  $("#autoapnRadio-1").attr("checked", "checked");
 }
}
function checkEnabledProfiles() {
 var j = document.getElementById("profileidx").value-1;
 en=0;
 for( i=0; i<stpf.length; i++ ) {
  if( (i!=j) && stpf[i].enable == 1) {
   en++;
  }
 }
 return en;
}
var max_enabled_profiles="2";
function profile_enable(en) {
 clear_alert();
 if(en=="1" && checkEnabledProfiles()>=max_enabled_profiles) {
  validate_alert("", "The maximum number of enabled profiles has been exceeded.");
  $("#pppAutoCon-1").attr("checked", "checked");
  return;
 }
 $("#gascEnable").val(en);
 if(en=="0") {
  $(".hide_profile_off").css("display","none");
 }
 else {
  $(".hide_profile_off").css("display","");
  if(document.formS.autoapnRadio[0].checked==true) {
   $(".hide_for_autoapn").css("display","none");
  }
  else {
   $(".hide_for_autoapn").css("display","");
  }
 }
 if(roam_simcard == "1") {
  $("#div_autoapn").css("display","none");
 }
}
</script>
<div class="header-wrap" id="main-menu"><!--Top Menu--></div>
<div id="content" class="site-content">
 <div class="container">
 <aside class="grid-3 alpha sidemenu" id="side-menu"><!--Side Menu--></aside>
 <div class="grid-9 omega">
  <form name="formS" id="form" class="validate" novalidate method="POST" action="Profile_Settings.html">
  <div class="right-column white-box">
   <div class="pad">
    <h2><script language=Javascript>document.write("Data connection profile settings")</script></h2>
    <input type="hidden" name="gascEnable" id="gascEnable" value="">
    <input type="hidden" name="snatEnable" id="snatEnable" value=""/>
    <input type="hidden" name="profileidx" id="profileidx" value="1">
    <input type="hidden" name="autoapn" id="autoapn" value="">
    <div class="form-row no-bg-form">
     <label for="pppAutoCon"><script language=Javascript>document.write("Profile")</script></label>
     <div class="field">
      <div class="location-settings">
       <div class="radio-switch">
        <input type="radio" id="pppAutoCon-0" name="pppAutoCon" class="access" value=1>
        <label for="pppAutoCon-0" class="on"><script language=Javascript>document.write("I")</script></label>
        <input type="radio" id="pppAutoCon-1" name="pppAutoCon" class="access" value=0>
        <label for="pppAutoCon-1" class="off"><script language=Javascript>document.write("0")</script></label>
       </div>
      </div>
     </div>
    </div>
    <div class="form-row">
     <label for="profilename"><script language=Javascript>document.write("Profile name")</script></label>
     <div class="field">
      <input type="text" class="validate[required] required large" name="profilename" id="profilename" onKeyUp="nameFilter(this);" value="">
     </div>
    </div>
    <div class="form-row no-bg-form" id="div_autoapn">
     <label for="autoapnRadio"><script language=Javascript>document.write("Automatic APN selection")</script></label>
     <div class="field">
      <div class="location-settings">
       <div class="radio-switch">
        <input type="radio" id="autoapnRadio-0" name="autoapnRadio" class="access" onclick='autoAPNchange()'/>
        <label for='autoapnRadio-0' class='on'><script language=Javascript>document.write("I")</script></label>
        <input type="radio" id="autoapnRadio-1" name="autoapnRadio" class="access" onclick='autoAPNchange()'/>
        <label for='autoapnRadio-1' class='off'><script language=Javascript>document.write("0")</script></label>
       </div>
      </div>
     </div>
    </div>
    <div class="grey-box hide_for_autoapn">
     <div class="form-row">
      <label for="APNName"><script language=Javascript>document.write("APN")</script></label>
      <div class="field">
       <input type="text" class="large" name="APNName" id="APNName" value="" maxlength='100'>
      </div>
     </div>
     <div class="form-row">
      <label for="pppuser"><script language=Javascript>document.write("Username")</script></label>
      <div class="field">
       <input type="text" class="large" name="pppuser" id="pppuser" value="user">
      </div>
     </div>
     <div class="form-row">
      <label for="ppppass"><script language=Javascript>document.write("Password")</script></label>
      <div class="field">
       <input type="password" class="large" name="ppppass" id="ppppass" value="">
      </div>
     </div>
     <div class="form-row no-bg-form show_for_perferredip">
      <input type="hidden" name="preferred_ipenable" id="preferred_ipenable">
      <input type="hidden" name="preferred_ipaddr" id="preferred_ipaddr">
      <div class="form-row">
       <label for="prefIpRadio"><script language=Javascript>document.write("Static IP address")</script></label>
       <div class="field">
        <div class="location-settings">
         <div class="radio-switch">
          <input type="radio" id="prefIpRadio-0" name="prefIpRadio" class="access" onclick='prefIPchange()'/>
          <label for='prefIpRadio-0' class='on'><script language=Javascript>document.write("I")</script></label>
          <input type="radio" id="prefIpRadio-1" name="prefIpRadio" class="access" onclick='prefIPchange()'/>
          <label for='prefIpRadio-1' class='off'><script language=Javascript>document.write("0")</script></label>
         </div>
        </div>
       </div>
      </div>
      <div class="form-row show_for_perferredipaddr">
       <label><script language=Javascript>document.write("Preferred IP address")</script></label>
       <script language="JavaScript">htmlGenIpBlocksWithoutRequired0("preferred_ipaddr");</script>
      </div>
     </div>
    </div>
    <div class="form-row show_for_autoapn">
     <label for="AuthType"><script language=Javascript>document.write("Authentication type")</script></label>
     <div class="radio-box-group">
      <div class="radio-box">
       <input type="radio" class="access" name="AuthType" id="AuthType-0" value="chap">
       <label for="AuthType-0"><div class="radioText"><script language=Javascript>document.write("CHAP")</script></div></label>
      </div>
      <div class="radio-box">
       <input type="radio" class="access" name="AuthType" id="AuthType-1" value="pap">
       <label for="AuthType-1"><div class="radioText"><script language=Javascript>document.write("PAP")</script></div></label>
      </div>
     </div>
    </div>
    <div class="form-row show_for_autoapn">
     <label for="reconnectDelay"><script language=Javascript>document.write("Reconnect delay")</script></label>
     <div class="field">
      <input type="text" class="validate[required,funcCall[validate_reconnectDelay]] required reconnectDelay sml" name="reconnectDelay" id="reconnectDelay" value="" onKeyUp="NumfieldEntry(this);">
      <span class="normal-text">&nbsp;<script language=Javascript>document.write("(30-65535) seconds")</script></span>
     </div>
    </div>
    <div class="form-row show_for_autoapn">
     <label for="reconnectRetries"><script language=Javascript>document.write("Reconnect retries")</script></label>
     <div class="field">
      <input type="text" class="validate[required,funcCall[validate_reconnectRetries]] required reconnectRetries sml" name="reconnectRetries" id="reconnectRetries" value="" onKeyUp="NumfieldEntry(this);">
      <span class="normal-text">&nbsp;<script language=Javascript>document.write("(0-65535, 0=Unlimited)")</script></span>
     </div>
    </div>
    <div class="form-row show_for_autoapn">
     <label for="metric"><script language=Javascript>document.write("Metric")</script></label>
     <div class="field">
      <input type="text" class="validate[required,funcCall[validate_metric]] required metric sml" name="metric" id="metric" onKeyUp="NumfieldEntry(this);" value="">
      <span class="normal-text">&nbsp;(0-65535)</span>
     </div>
    </div>
    <div class="form-row show_for_autoapn">
     <label for="mtu"><script language=Javascript>document.write("MTU")</script></label>
     <div class="field">
      <input type="text" class="validate[required,funcCall[validate_mtu]] required mtu sml" name="mtu" id="mtu" onKeyUp="NumfieldEntry(this);" value="1460">

      <!--<span class="normal-text">&nbsp;(1358-1460)</span>-->

      <span class="normal-text">&nbsp;(1-1500)</span>

     </div>
    </div>
    <div class="form-row no-bg-form show_for_autoapn">
     <label for="field-12"><script language=Javascript>document.write("NAT masquerading")</script></label>
     <div class="field">
      <div class="location-settings">
       <div class="radio-switch">
        <input type="radio" id="NatEnable-0" name="NatEnable" class="access" onClick="javascript:$('#snatEnable').val('1')">
        <label for="NatEnable-0" class="on"><script language=Javascript>document.write("I")</script></label>
        <input type="radio" id="NatEnable-1" name="NatEnable" class="access" onClick="javascript:$('#snatEnable').val('0')">
        <label for="NatEnable-1" class="off"><script language=Javascript>document.write("0")</script></label>
       </div>
      </div>
     </div>
    </div>
    <input type="hidden" name="routes" id="routes">
    <h2 class="show_for_autoapn"><script language=Javascript>document.write("Profile routing settings")</script></h2>
    <div class="p-des-full-width show_for_autoapn">
     <p><script language=Javascript>document.write("You may route only particular traffic via this connection profile by specifying the network address and mask below of the destination network. Blank values will route all traffic via this profile. Please leave these settings blank if you are unsure.")</script></p>
    </div>
    <div class="form-row no-bg-form show_for_autoapn">
     <label><script language=Javascript>document.write("Network address")</script></label>
     <script language="JavaScript">htmlGenIpBlocksWithoutRequired0("network");</script>
    </div>
    <div class="form-row no-bg-form show_for_autoapn">
     <label><script language=Javascript>document.write("Network mask")</script></label>
     <script language="JavaScript">htmlGenMaskBlocksWithoutRequired("netmask");</script>
    </div>
    <div class="submit-row">
     <button type="button" id="save" ><script language=Javascript>document.write("Save")</script></button>
     <button type="button" class="secondary" onClick="window.location='Profile_Name_List.html'"><script language=Javascript>document.write("Cancel")</script></button>
    </div>
   </div>
  </div>
  </form>
 </div>
</div>
</div>
<footer class="footer">
 <div class="container">
  <p class="copy-right"><script language=Javascript>document.write("Powered by Mongoose Advanced Technologies")</script></p>
 </div>
</footer>
<script language='javascript'>
set_menu("Internet", "Profile_List", "root");
$(document).ready(function() {
 Init_Form();
 // check pppoe serial
 $("input:radio[name=pppAutoCon]").click(function(){
  pppoe_en="0";
  if(pppoe_en == "1") {
   load_value_to_element($("input:radio[name=pppAutoCon]"),false);
   blockUI_alert("Please disable transparent bridge mode before configuring this connection");
  }
  else {
   profile_enable( $(this).val() );
  }
 });
 $("#save").click(function() {
 //	clear_alert();
/*********for vdf validator**********/
  if(!$("#form").valid()) {
   return;
  }
  ip_addr=parse_ip_from_fields("network");
  if(ip_addr!="") {
   if( !isValidIpAddress0(ip_addr) ) {
    validate_alert("", "Invalid ip address.");
    return;
   }
   switch(isValidSubnetMask(parse_ip_from_fields("netmask"))) {
    case -1:
     validate_alert("", "You have entered an invalid subnet mask. Please try again.");
     return;
    break;
    case -2:
     validate_alert("", "The subnet mask must be contiguous. Please try again.");//The subnet mask has to be contiguous. Please enter a valid mask
     return;
    break;
   }
  }
  ip_addr=parse_ip_from_fields("preferred_ipaddr");
  if ( $("#preferred_ipenable").val() == "1" ) {
   if(!isValidIpAddress0(ip_addr)) {
    validate_alert("", "Invalid ip address.");
    return;
   }
  }
  $("#preferred_ipaddr").val(ip_addr);
  var network_netmask=[parse_ip_from_fields("network"),parse_ip_from_fields("netmask")];
  $("#routes").val(network_netmask.join("/"));
  $("form[name=formS]").submit();
 });
});
/*********for vdf validator**********/
 VALIDATOR.config.errors["metric"]="Metric values must be between 0 and 65535. Please try again.";
 $.validator.addMethod("metric",function(c,a) {
  if(c!==$(a).attr("data-watermark")) {
   if( c < 0 || c > 65535 || !isAllNum(c) ) {
    return false;
   }
  }
  else if($(a).hasClass("required")) {
   return false;
  }
  return true;
 },VALIDATOR.config.errors.metric);

 VALIDATOR.config.errors["mtu"]="Error: MTU must have a value between 1358 and 1460";//Error: MTU must have a value between 1358 and 1460

 VALIDATOR.config.errors["mtu"]="Error: MTU must have a value between 1 and 1500";//Error: MTU must have a value between 1 and 1500

 $.validator.addMethod("mtu",function(c,a) {
  if(c!==$(a).attr("data-watermark")) {

   if( c < 1358 || c > 1460 || !isAllNum(c) ) {

   if( c < 1 || c > 1500 || !isAllNum(c) ) {

    return false;
   }
  }
  else if($(a).hasClass("required")) {
   return false;
  }
  return true;
 }},VALIDATOR.config.errors.mtu);
 VALIDATOR.config.errors["reconnectDelay"]="Reconnect delay values must be between 30 and 65535. Please try again.";
 $.validator.addMethod("reconnectDelay",function(c,a) {
  if(($(a).hasClass("required")&&c!==$(a).attr("data-watermark"))||(c!==$(a).attr("data-watermark"))) {
   if( c < 30 || c > 65535 ) {
    return false;
   }
  }
  else if($(a).hasClass("required")) {
   return false;
  }
  return true;
 },VALIDATOR.config.errors.reconnectDelay);
 VALIDATOR.config.errors["reconnectRetries"]="Reconnect Retries must have a value between 0 and 65535. Please try again.";
 $.validator.addMethod("reconnectRetries",function(c,a) {
  if(($(a).hasClass("required")&&c!==$(a).attr("data-watermark"))||(c!==$(a).attr("data-watermark"))) {
   if( c < 0 || c > 65535 ) {
    return false;
   }
  }
  else if($(a).hasClass("required")) {
   return false;
  }
  return true;
 },VALIDATOR.config.errors.reconnectRetries);
</script>
</body>
</html>
